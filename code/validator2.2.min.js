(function(f){f.Validator=function(a,b,e){this.el=f(b);this.namespace="validator";this.opts=f.extend(!0,{},f.Validator.settings,a);this.theFormRequired=this.el.find("."+this.opts.formClasses.requiredClass);this.theFormOptional=this.el.find("."+this.opts.formClasses.optionalClass);this.theFormValidationFields=this.el.find("."+this.opts.formClasses.requiredClass+", ."+this.opts.formClasses.optionalClass);this.init();"function"===typeof e&&e.call()};f.Validator.settings={inputTypes:{textField:{inputName:"firstName", rules:{min:2,max:20,lettersOnly:!0,noSpaces:!0}},textMessage:{inputName:"message",rules:{min:5,max:100,validHTMLTags:"<div>,<p>,<span>,<b>"}},urlField:{inputName:"url",rules:{validURL:!0}},selectBox:{inputName:"selectbox",rules:{selectHasValue:!0,selectNull:"-please select-"},error:"Please select a value for this field",valid:"the field is valid - woot!"},radioBtn:{inputName:"radio1",rules:{radioReq:!0}},fileData:{inputName:"fileData",rules:{fileType:"doc,txt,html"}},checkboxField:{inputName:"checkboxField", rules:{checkboxMin:1}},date:{inputName:"dateField",rules:{date:!0}}},formClasses:{submitClass:"submitField",resetClass:"reset",requiredClass:"required",optionalClass:"optional",errorClass:"error",errorMessage:"The field has an error!",validClass:"valid",validMessage:"The field should be valid!",fieldActive:"fieldActive",fieldActiveValid:"fieldActiveValid",fieldActiveInvalid:"fieldActiveInvalid"},longMonths:"january february march april may june july august september october november december".split(" "), shortMonths:"jan feb mar apr may jun jul aug sep oct nov dec".split(" "),longDays:"monday tuesday wednesday thursday friday saturday sunday".split(" "),shortDays:"mon tue wed thu fri sat sun".split(" "),errorCount:0,onChangeValidation:!0,submitFunction:!1};f.Validator.prototype={init:function(){var a=this;this.destroy();this.getValidationFields();this.el.on("submit."+a.namespace,function(){return a.validateForm()});this.el.find("."+this.opts.formClasses.resetClass).on("click."+a.namespace,function(){this.form.find("."+ this.opts.formClasses.errorClass).removeClass(this.opts.formClasses.validClass).removeClass(this.opts.formClasses.fieldActiveValid).removeClass(this.opts.formClasses.fieldActiveInvalid);this.form.find("."+this.opts.formClasses.errorClass).html("&#42;")})},getValidationFields:function(){var a=this;this.theFormRequired=this.el.find("."+this.opts.formClasses.requiredClass);this.theFormOptional=this.el.find("."+this.opts.formClasses.optionalClass);this.theFormValidationFields=this.el.find("."+this.opts.formClasses.requiredClass+ ", ."+this.opts.formClasses.optionalClass);this.theFormValidationFields.each(function(){var b=f(this);b.on("focus."+a.namespace,function(){b.addClass(a.opts.formClasses.fieldActive)});b.on("blur."+a.namespace,function(){b.removeClass(a.opts.formClasses.fieldActive);b.removeClass(a.opts.formClasses.fieldActiveValid);b.removeClass(a.opts.formClasses.fieldActiveInvalid);""!==b.prop("value")&&a.validateField(f(this))});b.on("change."+a.namespace,function(){a.validateField(b)});b.on("keyup."+a.namespace, function(){""!==b.prop("value")&&1==a.opts.onChangeValidation&&a.validateField(b)});if("checkbox"==b.attr("type")||"radio"==b.attr("type"))b.on("click."+a.namespace,function(){a.validateField(b)})})},validateForm:function(){var a=this;a.opts.errorCount=0;a.theFormRequired.each(function(){a.validateField(f(this))});if(0===a.opts.errorCount)return"function"===typeof a.opts.submitFunction?(a.opts.submitFunction.call(),!1):!0;a.el.find("."+a.opts.formClasses.fieldActiveValid).removeClass(a.opts.formClasses.fieldActiveValid); "function"===typeof a.opts.errorFunction&&a.opts.errorFunction.call();return!1},validateField:function(a){var b=!1,e=a.attr("name"),c=a.prop("value"),d,m,l,h,k,g;0<a.children("option").length&&(c=a.children("option:selected").text());""===c&&(b=!0);for(g in this.opts.inputTypes)e==this.opts.inputTypes[g].inputName&&(d=this.opts.inputTypes[g].rules,m=this.opts.inputTypes[g].error,l=this.opts.inputTypes[g].valid);c&&(c=this.stripWhiteSpace(c));for(g in d)if(d.hasOwnProperty(g)){switch(g){case "min":c.length< d[g]&&(b=!0,h="Must be at least "+d[g]+" characters");break;case "max":c.length>d[g]&&(b=!0,h="Must be less than "+d[g]+" characters");break;case "minValue":parseFloat(c)<d[g]&&(b=!0,h="the value is lower than the minimum value");break;case "maxValue":parseFloat(c)>d[g]&&(b=!0,h="the value is higher than the maximum allowed");break;case "checkboxMin":k=f("input[name="+e+"]:checked");k.length<d[g]&&(b=!0,h="More options need to be selected");break;case "checkboxMax":k=f("input[name="+e+"]:checked"); !0===d[g]?k.length!==f("input[name="+e+"]").length&&(b=!0,h="All these checkboxes need to be set"):k.length>d[g]&&(b=!0,h="More than the maximum allowable have been selected");break;case "radioReq":k=f("input[name="+e+"]:checked");1<k.length&&(b=!0,h="More than radio field has been selected");break;case "selectNull":c==d[g]&&(b=!0,h="Please select a value");break;case "fileType":this.isFileValid(c,d[g])||(b=!0,h="The wrong type of file has been selected");break;case "isNumber":d[g]&&!this.isNumber(c)&& (b=!0,h="The value is not a number");break;case "lettersOnly":d[g]&&!this.isText(c)&&(b=!0,h="The input can only be text");break;case "validPassword":d[g]&&!this.isValidPassword(c)&&(b=!0,h="The password has illegal characters");break;case "passConfirm":k=a.attr("title");k=f("input[type='password'][title="+k+"][name!="+e+"]").prop("value");c!=k&&(b=!0,h="The password does not match");break;case "validURL":d[g]&&!this.isValidURL(c)&&(b=!0,h="That is not a valid URL");break;case "validEmail":d[g]&& !this.isValidEmail(c)&&(b=!0,h="That is not a valid email address");break;case "date":!0===d[g]&&(k=this.getDateArray(c),k&&this.isValidDate(k)||(b=!0,h="The date format is not valid"));break;case "dateFuture":!0===d[g]&&(k=this.getDateArray(c),k&&"future"==this.dateTense(k)||(b=!0,h="The date needs to be in the future"));break;case "datePast":!0===d[g]&&(k=this.getDateArray(c),k&&"past"==this.dateTense(k)||(b=!0,h="The date needs to be in the past"));break;case "checkHTMLTags":!0===d[g]&&this.findHTML(c)&& (b=!0,h="The input contains HTML tags");break;case "validHTMLTags":d[g]&&this.findHTMLTags(c,d[g])&&(b=!0,h="The input contains non-valid HTML tags");break;case "noSpaces":d[g]&&1<c.split(" ").length&&(b=!0,h="There are spaces in the input")}!0===b?(k=m?m:h,f("."+this.opts.formClasses.errorClass+"[title='"+e+"']").html(k),a.removeClass("fieldActiveValid").addClass("fieldActiveInvalid"),this.opts.errorCount++):(k=l?l:this.opts.formClasses.validMessage,f("."+this.opts.formClasses.errorClass+"[title='"+ e+"']").html('<span class="'+this.opts.formClasses.validClass+'">'+k+"</span>"),a.removeClass("fieldActiveInvalid").addClass("fieldActiveValid"))}},isFileValid:function(a,b){var e=b.split(","),c=a.split("/"),c=c[c.length-1].split("."),c=c[c.length-1],d;for(d=0;d<e.length;d++)if(c==e[d])return!0;return!1},isValidURL:function(a){return/^(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][\-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([\-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([\-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([\-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?$/.test(a)}, isValidEmail:function(a){return/^((([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+(\.([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+)*)@((((([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.))*([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.)[\w]{2,4}|(((([0-9]){1,3}\.){3}([0-9]){1,3}))|(\[((([0-9]){1,3}\.){3}([0-9]){1,3})\])))$/.test(a)},stripWhiteSpace:function(a){return a.replace(/^\s+|\s+$/g,"")},hasWhiteSpace:function(a){return/[\s+]/.test(a)},haveValue:function(a){return""!== a.replace(/^\s+|\s+$/g,"")?!0:!1},isText:function(a){return!/[^a-zA-Z\s]/.test(a)},isUsername:function(a){return!/[^a-zA-Z0-9\_\s]/.test(a)},isNumber:function(a){return/^([\-\+]?[0-9]+[\.]?[0-9]+|[\-\+]?[\.]?[0-9]+){1}$/.test(a)},isMoney:function(a){var b=!1;void 0!=a.split(".")&&(b=a.split("."));return b&&2==b.length?3>b[1].length?!0:!1:!0},isValidPassword:function(a){return/^[a-zA-Z0-9!\@#\$%\^&\*\(\)\-\+=\.\?]+$/.test(a)},findHTMLTags:function(a,b){var e=a,c=b.split(","),d="",f;for(f in c)c.hasOwnProperty(f)&& (d=c[f].replace(/[<>]/g,""),d="</?"+d+"\\s?([a-zA-Z]+=[\"'][^>\"']+[\"']|[^>\"']+)*>",d=new RegExp(d,"gi"),e=e.replace(d,""));return/<\/?[a-zA-Z]+\s?([a-zA-Z]+=["'][^>"']+["']|[^>"']+)*>/.test(e)},getDateArray:function(a){var b,e,c,d;a=a.replace(",","");a=a.replace(/[\s]+?/g," ");a=a.split(/[\s\-\/]/);for(c=0;c<a.length;c++)""===a[c]&&(a.splice(c,1),c--);for(c in this.opts.longDays)if(this.opts.longDays.hasOwnProperty(c))for(d in a)a.hasOwnProperty(d)&&a[d]==this.opts.longDays[c]&&(b=!0,e=d);for(c in this.opts.shortDays)if(this.opts.shortDays.hasOwnProperty(c))for(d in a)a.hasOwnProperty(d)&& a[d]==this.opts.shortDays[c]&&(b=!0,e=d);for(c in a)a[c]&&(a[c]=a[c].replace(/(st)|(nd)|(rd)|(th)/gi,""));4===a.length&&!0===b&&a.splice(e,1);return 3==a.length?a:!1},isValidDate:function(a){var b=!1,e=!1,c=!1,d,f=/^[0-9]{1,2}$/,l,h,k=31;if(f.test(a[1])&&0<a[1]&&13>a[1])l=parseInt(a[1],10),b=!0;else{for(d in this.opts.longMonths)a[1].toLowerCase()==this.opts.longMonths[d]&&(l=parseInt(d,10)+1,b=!0);for(d in this.opts.shortMonths)a[1].toLowerCase()==this.opts.shortMonths[d]&&(l=parseInt(d,10)+1,b= !0)}f=/^([0-9]{2}|[0-9]{4})$/;f.test(a[2])&&(0<=a[2]&&100>a[2]||1E3<a[2]&&3E3>a[2])&&(h=a[2],e=!0);4==l||6==l||9==l||11==l?k=30:2===l&&(k=0!==h%4||0===h%100&&0!==h%400?28:29);0<a[0]&&a[0]<=k&&(c=!0);return!0===c&&!0===b&&!0===e?!0:!1},dateTense:function(a){var b,e;for(e in this.opts.longMonths)this.opts.longMonths.hasOwnProperty(e)&&(b=(a[1]+"").toLowerCase(),b==this.opts.longMonths[e]&&(a[1]=parseInt(e,10)+1));for(e in this.opts.shortMonths)this.opts.shortMonths.hasOwnProperty(e)&&(b=(a[1]+"").toLowerCase(), b==this.opts.shortMonths[e]&&(a[1]=parseInt(e,10)+1));--a[1];100>a[2]&&(a[2]=parseInt(a[2],10)+2E3);b=new Date;b.setFullYear(a[2],a[1],a[0]);b=Math.round(b.getTime()/864E5);a=new Date;a=Math.round(a.getTime()/864E5);return b>a?"future":b<a?"past":"today"},option:function(a){this.opts=f.extend(!0,{},this.opts,a)},destroy:function(){this.el.off("."+this.namespace)}};f.fn.validator=function(a,b){var e;"string"===typeof a?(e=Array.prototype.slice.call(arguments,1),this.each(function(){var b=f.data(this, "validator");b?f.isFunction(b[a])&&"_"!==a.charAt(0)?b[a].apply(b,e):alert("the plugin contains no such method: "+a):alert("The plugin has not been initialised yet when you tried to call this method: "+a)})):this.each(function(){var c=f.data(this,"validator");c?c.option(a):f.data(this,"validator",new f.Validator(a,this,b))});return this}})(jQuery);