/*
	jQuery Form Validator Plugin v1.3
	Copyright (c) 2011 Daniel Thomson
	
	Licensed under the MIT license:
	http://www.opensource.org/licenses/mit-license.php
*/

(function(b){b.fn.validator=function(d){b.fn.validator.defaults={inputTypes:{textField:{inputName:"firstName",rules:{min:2,max:20,lettersOnly:true,noSpaces:true}},textMessage:{inputName:"message",rules:{min:5,max:100,validHTMLTags:"<div>,<p>,<span>,<b>"}},passwordField:{inputName:"password",rules:{min:6,max:12,validPassword:true}},confirmPasswordField:{inputName:"confirmpassword",rules:{passConfirm:true}},urlField:{inputName:"url",rules:{validURL:true}},emailField:{inputName:"email",rules:{validEmail:true}}, selectBox:{inputName:"selectbox",rules:{selectHasValue:true,selectNull:"-please select-"},message:"Please select a value for this field"},radioBtn:{inputName:"radio1",rules:{radioReq:true}},fileData:{inputName:"fileData",rules:{fileType:"doc,txt,html"}},checkboxField:{inputName:"checkboxField",rules:{checkboxMin:1}},date:{inputName:"dateField",rules:{date:true}}},formClasses:{submitClass:"submitField",resetClass:"reset",requiredClass:"required",errorClass:"error",validClass:"valid",validMessage:"field should be valid", fieldActive:"fieldActive",fieldActiveValid:"fieldActiveValid",fieldActiveInvalid:"fieldActiveInvalid"},longMonths:["january","february","march","april","may","june","july","august","september","october","november","december"],shortMonths:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],longDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],shortDays:["mon","tue","wed","thu","fri","sat","sun"],errorCount:0};var c=b.extend(true,{},b.fn.validator.defaults, d),a=b(this),f=b(this).find("."+c.formClasses.requiredClass);this.each(function(){f.each(function(){b(this).focus(function(){b(this).addClass(c.formClasses.fieldActive)});b(this).blur(function(){b(this).removeClass(c.formClasses.fieldActive);b(this).removeClass(c.formClasses.fieldActiveValid);b(this).removeClass(c.formClasses.fieldActiveInvalid)});b(this).change(function(){b(this).hasClass(c.formClasses.requiredClass)&&b.fn.validator.validateField(b(this),c)});b(this).keyup(function(){b(this).hasClass(c.formClasses.requiredClass)&& b(this).attr("value")!==""&&b.fn.validator.validateField(b(this),c)});if((b(this).attr("type")=="checkbox"||b(this).attr("type")=="radio")&&b(this).hasClass(c.formClasses.requiredClass))b(this).click(function(){b.fn.validator.validateField(b(this),c)})});a.submit(function(){c.errorCount=0;f.each(function(){b.fn.validator.validateField(b(this),c)});if(c.errorCount===0)return true;else{alert("you still have "+c.errorCount+" errors in the form");a.find("."+c.formClasses.fieldActiveValid).removeClass(c.formClasses.fieldActiveValid); return false}});a.find("."+c.formClasses.resetClass).click(function(){a.find("."+c.formClasses.errorClass).removeClass(c.formClasses.validClass).removeClass(c.formClasses.fieldActiveValid).removeClass(c.formClasses.fieldActiveInvalid);a.find("."+c.formClasses.errorClass).html("&#42;")})});return this};b.fn.validator.validateField=function(d,c){var a=false,f=d.attr("name"),g=d.attr("value"),e,k,h,j,i;if(d.children("option").length>0)g=d.children("option:selected").text();if(g==="")a=true;for(i in c.inputTypes)if(f== c.inputTypes[i].inputName){e=c.inputTypes[i].rules;k=c.inputTypes[i].message}g=b.fn.validator.stripWhiteSpace(g);for(i in e)if(e.hasOwnProperty(i)){switch(i){case "min":if(g.length<e[i]){a=true;h="The input is less than the minimum required"}break;case "max":if(g.length>e[i]){a=true;h="The input is longer than the minimum required"}break;case "checkboxMin":j=b("input[name="+f+"]:checked");if(j.length<e[i]){a=true;h="More options need to be selected"}break;case "checkboxMax":j=b("input[name="+f+"]:checked"); if(j.length>e[i]){a=true;h="More than the maximum allowable have been selected"}break;case "radioReq":j=b("input[name="+f+"]:checked");if(j.length>1){a=true;h="More than radio field has been selected"}break;case "selectNull":if(g==e[i]){a=true;h="Please select a value"}break;case "fileType":if(!b.fn.validator.isFileValid(g,e[i])){a=true;h="The wrong type of file has been selected"}break;case "isNumber":if(e[i]&&!b.fn.validator.isNumber(g)){a=true;h="The value is not a number"}break;case "lettersOnly":if(e[i]&& !b.fn.validator.isText(g)){a=true;h="The input can only be text"}break;case "validPassword":if(e[i]&&!b.fn.validator.isValidPassword(g)){a=true;h="The password has illegal characters"}break;case "passConfirm":j=d.attr("title");j=b("input[type='password'][title="+j+"][name!="+f+"]").attr("value");if(g!=j){a=true;h="The password does not match"}break;case "validURL":if(e[i]&&!b.fn.validator.isValidURL(g)){a=true;h="That is not a valid URL"}break;case "validEmail":if(e[i]&&!b.fn.validator.isValidEmail(g)){a= true;h="That is not a valid email address"}break;case "date":if(e[i]===true){j=b.fn.validator.getDateArray(g,c);if(!j||!b.fn.validator.isValidDate(j,c)){a=true;h="The date format is not valid"}}break;case "dateFuture":if(e[i]===true){j=b.fn.validator.getDateArray(g,c);if(!j||b.fn.validator.dateTense(j,c)!="future"){a=true;h="The date needs to be in the future"}}break;case "datePast":if(e[i]===true){j=b.fn.validator.getDateArray(g,c);if(!j||b.fn.validator.dateTense(j,c)!="past"){a=true;h="The date needs to be in the past"}}break; case "checkHTMLTags":if(e[i]===true)if(b.fn.validator.findHTML(g,c)){a=true;h="The input contains HTML tags"}break;case "validHTMLTags":if(e[i]&&b.fn.validator.findHTMLTags(g,e[i])){a=true;h="The input contains non-valid HTML tags"}break;case "noSpaces":if(e[i]&&g.split(" ").length>1){a=true;h="There are spaces in the input"}}if(a===true){k?b("."+c.formClasses.errorClass+"[title="+f+"]").html(k):b("."+c.formClasses.errorClass+"[title="+f+"]").html(h);c.errorCount++;d.removeClass("fieldActiveValid").addClass("fieldActiveInvalid")}else{b("."+ c.formClasses.errorClass+"[title="+f+"]").html('<span class="'+c.formClasses.validClass+'">'+c.formClasses.validMessage+"</span>");d.removeClass("fieldActiveInvalid").addClass("fieldActiveValid")}}};b.fn.validator.isFileValid=function(d,c){var a=c.split(","),f=d.split("/");f=f[f.length-1].split(".");f=f[f.length-1];var g;for(g=0;g<a.length;g++)if(f==a[g])return true;return false};b.fn.validator.isValidURL=function(d){return/^(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][\-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([\-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([\-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([\-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?$/.test(d)? true:false};b.fn.validator.isValidEmail=function(d){return/^((([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+(\.([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+)*)@((((([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.))*([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.)[\w]{2,4}|(((([0-9]){1,3}\.){3}([0-9]){1,3}))|(\[((([0-9]){1,3}\.){3}([0-9]){1,3})\])))$/.test(d)?true:false};b.fn.validator.stripWhiteSpace=function(d){return d.replace(/^\s+|\s+$/g,"")};b.fn.validator.haveValue= function(d){return d.replace(/^\s+|\s+$/g,"")!==""?true:false};b.fn.validator.isText=function(d){return/[^a-zA-Z\s]/.test(d)?false:true};b.fn.validator.isNumber=function(d){return/^([\-\+]?[0-9]+[\.]?[0-9]+|[\-\+]?[\.]?[0-9]+){1}$/.test(d)?true:false};b.fn.validator.isValidPassword=function(d){return/^[a-zA-Z0-9!\@#\$%\^&\*\(\)\-\+=\.\?]+$/.test(d)?true:false};b.fn.validator.findHTMLTags=function(d,c){var a=d,f=c.split(","),g="",e;for(e in f)if(f.hasOwnProperty(e)){g="</?"+f[e].replace(/[<>]/g,"")+ "\\s?([a-zA-Z]+=[\"'][^>\"']+[\"']|[^>\"']+)*>";g=RegExp(g,"gi");a=a.replace(g,"")}return/<\/?[a-zA-Z]+\s?([a-zA-Z]+=["'][^>"']+["']|[^>"']+)*>/.test(a)?true:false};b.fn.validator.getDateArray=function(d,c){var a,f,g,e,k;d=d.replace(",","");d=d.replace(/[\s]+?/g," ");a=d.split(/[\s\-\/]/);for(e=0;e<a.length;e++)if(a[e]===""){a.splice(e,1);e--}for(e in c.longDays)if(c.longDays.hasOwnProperty(e))for(k in a)if(a.hasOwnProperty(k))if(a[k]==c.longDays[e]){f=true;g=k}for(e in c.shortDays)if(c.shortDays.hasOwnProperty(e))for(k in a)if(a.hasOwnProperty(k))if(a[k]== c.shortDays[e]){f=true;g=k}for(e in a)if(a[e])a[e]=a[e].replace(/(st)|(nd)|(rd)|(th)/gi,"");a.length===4&&f===true&&a.splice(g,1);if(a.length==3)return a;return false};b.fn.validator.isValidDate=function(d,c){var a=false,f=false,g=false,e,k=/^[0-9]{1,2}$/,h,j,i=31;if(k.test(d[1])&&d[1]>0&&d[1]<13){h=parseInt(d[1],10);a=true}else{for(e in c.longMonths)if(d[1].toLowerCase()==c.longMonths[e]){h=parseInt(e,10)+1;a=true}for(e in c.shortMonths)if(d[1].toLowerCase()==c.shortMonths[e]){h=parseInt(e,10)+1; a=true}}k=/^([0-9]{2}|[0-9]{4})$/;if(k.test(d[2])&&(d[2]>=0&&d[2]<100||d[2]>1E3&&d[2]<3E3)){j=d[2];f=true}if(h==4||h==6||h==9||h==11)i=30;else if(h===2)i=j%4===0&&(j%100!==0||j%400===0)?29:28;if(d[0]>0&&d[0]<=i)g=true;return g===true&&a===true&&f===true?true:false};b.fn.validator.dateTense=function(d,c){var a,f;for(f in c.longMonths)if(c.longMonths.hasOwnProperty(f)){a=(d[1]+"").toLowerCase();if(a==c.longMonths[f])d[1]=parseInt(f,10)+1}for(f in c.shortMonths)if(c.shortMonths.hasOwnProperty(f)){a= (d[1]+"").toLowerCase();if(a==c.shortMonths[f])d[1]=parseInt(f,10)+1}d[1]-=1;if(d[2]<100)d[2]=parseInt(d[2],10)+2E3;a=new Date;a.setFullYear(d[2],d[1],d[0]);a=Math.round(a.getTime()/864E5);f=new Date;f=Math.round(f.getTime()/864E5);return a>f?"future":a<f?"past":"today"}})(jQuery);